<!DOCTYPE html>
<html>
    <head>
        <script src="./index.js" type="module" defer></script>
        <script type="text/javascript">
            /**
             * Example and test case section
             */
            window.addEventListener('load', () => {
                main();
            });

            function main() {
                var c = document.getElementById('c');
                c.width = c.parentElement.clientWidth;
                c.height = c.parentElement.clientHeight;
                //var gl = c.getContext('webgl');
                var ctx = c.getContext('2d');

                //window.requestAnimationFrame(function () { drawRandom(gl); });
                window.requestAnimationFrame(function () { drawRandomCtx(ctx); });
            }

            function drawRandom(gl, lt = Date.now()) {
                let tt = Date.now();
                document.getElementById('fps').innerHTML = 1000 / (tt - lt);
                lt = tt;

                gl.clear(gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT);

                jsCanvasTools.webgl.shapes.rect.clear();
                for (let i = 0; i < 200; i++){
                    jsCanvasTools.webgl.shapes.rect.set(
                        gl,
                        Math.random() * gl.canvas.width,
                        Math.random() * gl.canvas.height,
                        Math.random() * gl.canvas.width,
                        Math.random() * gl.canvas.height,
                        [Math.random(), Math.random(), Math.random(), 1.0],
                        [Math.random(), Math.random(), Math.random(), 1.0],
                        10
                    );
                }
                jsCanvasTools.webgl.shapes.rect.draw(gl);
                window.requestAnimationFrame(function () { drawRandom(gl, lt); });
            }

            function drawRandomCtx(ctx, lt = Date.now()) {
                let tt = Date.now();
                document.getElementById('fps').innerHTML = 1000 / (tt - lt);
                lt = tt;

                ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
                
                for (let i = 0; i < 200; i++){
                    ctx.beginPath();
                    ctx.rect(
                        Math.random() * ctx.canvas.width,
                        Math.random() * ctx.canvas.height,
                        Math.random() * ctx.canvas.width,
                        Math.random() * ctx.canvas.height
                    );
                    ctx.fillStyle = randomColor();
                    ctx.strokeStyle = randomColor();
                    ctx.lineWidth = 10;
                    ctx.fill();
                    ctx.stroke();
                    //ctx.endPath();
                }
                window.requestAnimationFrame(function () { drawRandomCtx(ctx, lt); });
            }

            function randomColor() {
                return "#" + Math.floor(Math.random()*16777215).toString(16);
            }
        </script>
        <style>
            #background {
                width: 100vw;
                height: 100vh;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                position: absolute;
                z-index: -1;
            }
            #c {
                border: 1px solid black;
            }
        </style>
    </head>
    <body>
        <div id="background">
            <canvas id="c"></canvas>
        </div>
        <div>
            <h1 id="fps"></h1>
        </div>
    </body>
</html>
